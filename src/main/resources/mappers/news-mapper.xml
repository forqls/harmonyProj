<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="kh.GiveHub.news.model.mapper.NewsMapper">
	<select id="selectNews"> select * from news_view where news_no = #{newsNo} </select>
	<select id="selectNewsList"> select * from news_view order by news_no </select>
	<update id="deleteNews"> update news set news_status = 'N' where news_no = #{nNo} </update>
	<select id="nnewsList">
		select * from news_view where news_status = 'Y'
		<if test="doNo != 0"> and do_no = #{doNo} </if>
		order by news_no desc
	</select>
	<insert id="insertNews">
		<selectKey order="BEFORE" resultType="_int" keyProperty="newsNo">
			SELECT nextval('seq_news_no')
		</selectKey>
		insert into news values (#{newsNo}, #{newsTitle}, 'null', default, default, #{memNo}, #{doNo})
	</insert>
	<update id="setContent"> update news set news_content = #{newContent} where news_no = #{newsNo} </update>
	<update id="updateNews"> update news set news_title = #{newsTitle} where news_no = #{newsNo} </update>
	<select id="getOldContent"> select news_content from news where news_no = #{newsNo} </select>
	<select id="newsDetail"> select * from news_view where news_no = #{newsNo} </select>
	<select id="selectNewsNew" resultType="kh.GiveHub.news.model.vo.News">
		SELECT
		n.news_no AS "newsNo",
		n.news_title AS "newsTitle",
		n.news_createdate AS "newsCreateDate",
		m.mem_name AS "memName",
		d.do_category AS "doCategory",
		i.img_path AS "thumbnailPath"
		FROM
		news n
		JOIN
		member m ON n.mem_no = m.mem_no
		LEFT JOIN
		donation d ON n.do_no = d.do_no
		LEFT JOIN
		image i ON (n.do_no = i.ref_no AND i.board_type = 'D' AND i.img_type = '0')
		WHERE
		n.news_status = 'Y'
		ORDER BY
		n.news_createdate DESC
		LIMIT 3
	</select>
	<select id="selectNewsDetail"> select * from news_view where news_no = #{newsNo} </select>
	<update id="deleteNews2"> update news set news_status ='N' where news_no = #{newsNo} </update>
</mapper>